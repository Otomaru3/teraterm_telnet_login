;============================================= 
TTINI = "teraterm.ini"
;============================================= 

;parse filename with '#'
strsplit param1 '#'

;parsed characters
HOSTNAME = groupmatchstr1
HOSTADDR = groupmatchstr2
USERNAME = groupmatchstr3
PASSWORD = groupmatchstr4
ENABLEPW = groupmatchstr5

getdir CurDir

;; build command
COMMAND = HOSTADDR 
strconcat COMMAND ':23 /nossh /T=1'
strconcat COMMAND ' /F='
strconcat COMMAND CurDir
strconcat COMMAND '\'
strconcat COMMAND TTINI
 
;; connect
connect COMMAND
 
;; Login
wait 'login:' 'Username:' 
sendln USERNAME 
sendln PASSWORD
sendln 'enable'
sendln ENABLEPW

wait '#'

call Logging

sendln ''
sendln 'show clock'
sendln ''

end

;---------------------------------------------------------------
;---------------------------------------------------------------
:Logging

Logfile = CurDir
strconcat Logfile '\log\'
strconcat Logfile HOSTNAME
getdate Logdatetime '_%Y%m%d-%H%M%S'
strconcat Logfile Logdatetime
strconcat Logfile '.log'

logopen Logfile 0 1 0

return
;---------------------------------------------------------------
